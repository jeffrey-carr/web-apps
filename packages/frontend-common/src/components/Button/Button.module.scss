/* Theme hooks: scope vars to the module root class */
:where(.root) {
  --btn-bg-color: var(--jeffs-btn-bg-color, var(--theme-primary));
  --btn-color: var(--jeffs-btn-color, var(--theme-text-primary));

  /* scale */
  --btn-px-sm: 0.6rem;  --btn-py-sm: 0.35rem;  --btn-fz-sm: 0.85rem;
  --btn-px-md: 0.9rem;  --btn-py-md: 0.55rem;  --btn-fz-md: 1rem;
  --btn-px-lg: 1.15rem; --btn-py-lg: 0.75rem;  --btn-fz-lg: 1.1rem;
  --btn-px-xl: 1.4rem;  --btn-py-xl: 0.95rem;  --btn-fz-xl: 1.2rem;

  /* shape */
  --btn-radius-rect: 0.5rem;
  --btn-radius-rounded: 0.9rem;
  --btn-radius-pill: 999px;

  /* motion/depth */
  --btn-dur: 140ms;
  --btn-ease: cubic-bezier(.2,.9,.2,1);
  --btn-shadow-raised: 0 4px 10px rgba(0,0,0,.12), 0 1px 0 rgba(0,0,0,.06) inset;
  --btn-shadow-3d: 0 6px 0 var(--theme-border-color), 0 10px 18px rgba(0,0,0,.18);
  --btn-press-translate: 2px;
}

/* Base */
.root {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  height: 2.5rem;

  font: inherit;
  font-weight: 600;
  line-height: 1;
  text-decoration: none;
  cursor: pointer;
  user-select: none;
  -webkit-tap-highlight-color: transparent;

  padding: 0.5rem;

  border-width: 1px;
  border-style: solid;
  outline: none;

  /* keep working even if vars go missing (fallbacks) */
  transition:
    transform var(--btn-dur, 140ms) var(--btn-ease, ease),
    box-shadow var(--btn-dur, 140ms) var(--btn-ease, ease),
    filter var(--btn-dur, 140ms) var(--btn-ease, ease),
    background-color var(--btn-dur, 140ms) var(--btn-ease, ease),
    color var(--btn-dur, 140ms) var(--btn-ease, ease),
    border-color var(--btn-dur, 140ms) var(--btn-ease, ease);

  /* Sizes via data-attr */
  &[data-size="sm"] { padding: var(--btn-py-sm) var(--btn-px-sm); font-size: var(--btn-fz-sm); }
  &[data-size="md"] { padding: var(--btn-py-md) var(--btn-px-md); font-size: var(--btn-fz-md); }
  &[data-size="lg"] { padding: var(--btn-py-lg) var(--btn-px-lg); font-size: var(--btn-fz-lg); }
  &[data-size="xl"] { padding: var(--btn-py-xl) var(--btn-px-xl); font-size: var(--btn-fz-xl); }

  /* Shapes */
  &[data-shape="rect"]    { border-radius: var(--btn-radius-rect); }
  &[data-shape="rounded"] { border-radius: var(--btn-radius-rounded); }
  &[data-shape="pill"]    { border-radius: var(--btn-radius-pill); }

  /* Variants */
  &[data-variant="solid"] {
    background: var(--btn-bg-color);
    color: var(--btn-color);
    border-color: var(--theme-border-color);

    /* hover/focus/active */
    &:hover {
      background-color: color-mix(in oklab, var(--theme-primary), transparent 85%);
      border-color: color-mix(in oklab, var(--theme-primary), transparent 20%);
    }
    &:focus-visible {
      outline: 2px solid color-mix(in oklab, var(--theme-primary), white 30%);
      outline-offset: 2px;
    }
    &:active {
      background-color: color-mix(in oklab, var(--theme-primary), transparent 75%);
    }
  }

  &[data-variant="outline"] {
    --btn-bg-color: var(--jeffs-btn-bg-color, transparent);
  
    background: var(--btn-bg-color);
    color: var(--btn-color);
    border-color: var(--theme-text-primary);

    /* hover/focus/active */
    &:hover {
      background-color: color-mix(in oklab, var(--theme-text-primary), transparent 85%);
      border-color: color-mix(in oklab, var(--theme-text-primary), transparent 20%);
    }
    &:focus-visible {
      outline: 2px solid color-mix(in oklab, var(--btn-color), white 30%);
      outline-offset: 2px;
    }
    &:active {
      background-color: color-mix(in oklab, var(--btn-color), transparent 75%);
    }
  }

  &[data-variant="ghost"] {
    --btn-bg-color: var(--jeffs-btn-bg-color, transparent);

    background: var(--btn-bg-color);
    color: var(--btn-color);
    border-color: transparent;
    box-shadow: none;

    /* subtle ink/hover */
    &:hover {
      background-color: color-mix(in oklab, var(--btn-color), transparent 90%);
    }
    &:focus-visible {
      outline: 2px solid color-mix(in oklab, var(--btn-color), white 30%);
      outline-offset: 2px;
    }
    &:active {
      background-color: color-mix(in oklab, var(--btn-color), transparent 82%);
    }
  }

  /* Depth */
  &[data-depth="flat"]   { box-shadow: none; }
  &[data-depth="raised"] { 
    box-shadow: var(--btn-shadow-raised);

    &:active {
      transform: translateY(var(--btn-press-translate));
    }
  }
  &[data-depth="3d"]     { 
    box-shadow: var(--btn-shadow-3d); 
    transform: translateY(0); 

    &:active {
      transform: translateY(var(--btn-press-translate));
    }
  }

  /* Solid hover/active (keep separate so depth overrides still apply) */
  &[data-variant="solid"].is-animated:not([aria-disabled="true"]):hover {
    filter: brightness(1.04);
  }
  &[data-variant="solid"].is-animated:active:not([aria-disabled="true"]) {
    transform: translateY(var(--btn-press-translate));
  }
  &[data-variant="solid"][data-depth="3d"].is-animated:active:not([aria-disabled="true"]) {
    box-shadow: 0 3px 0 var(--theme-border-color), 0 6px 12px rgba(0,0,0,.18);
  }

  /* Disabled */
  &[aria-disabled="true"],
  &:disabled {
    cursor: not-allowed;
    opacity: 0.6;
    filter: none;
    pointer-events: none;
  }
}

/* Content + spinner */
.content {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
}

.loading {
  height: 100%;
  aspect-ratio: 1 / 1;
}
